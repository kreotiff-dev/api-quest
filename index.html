<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Практикум - Платформа для обучения тестированию API</title>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Экран авторизации -->
    <div id="auth-screen" class="screen">
        <div class="auth-container">
            <div class="auth-box">
                <div class="auth-header">
                    <h2>API Практикум</h2>
                    <p>Войдите в аккаунт, чтобы продолжить обучение</p>
                    <div id="auth-debug-status" style="margin-top: 10px; padding: 5px; border-radius: 4px; font-size: 12px; text-align: center;"></div>
                </div>
                <div class="auth-tabs">
                    <div class="auth-tab active" data-tab="login">Вход</div>
                    <div class="auth-tab" data-tab="register">Регистрация</div>
                </div>
                
                <div class="auth-form-container">
                    <!-- Форма входа -->
                    <form id="login-form" class="auth-form active">
                        <div class="form-group">
                            <label for="login-email">Email</label>
                            <input type="email" id="login-email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="login-password">Пароль</label>
                            <input type="password" id="login-password" name="password" required>
                        </div>
                        <button type="submit" class="btn btn-primary btn-block">Войти</button>
                    </form>
                    
                    <!-- Форма регистрации -->
                    <form id="register-form" class="auth-form">
                        <div class="form-group">
                            <label for="register-name">Имя</label>
                            <input type="text" id="register-name" name="name" required>
                        </div>
                        <div class="form-group">
                            <label for="register-email">Email</label>
                            <input type="email" id="register-email" name="email" required>
                        </div>
                        <div class="form-group">
                            <label for="register-password">Пароль</label>
                            <input type="password" id="register-password" name="password" required minlength="6">
                            <small>Не менее 6 символов</small>
                        </div>
                        <button type="submit" class="btn btn-primary btn-block">Зарегистрироваться</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Экран выбора заданий -->
    <div id="tasks-screen" class="screen">
        <header class="main-header">
            <div class="logo">
                <h1>API Практикум</h1>
            </div>
            <div class="user-info">
                <div class="user-profile">
                    <i class="fas fa-user-circle"></i>
                    <span id="user-name">Студент</span>
                </div>
                <div class="user-actions">
                    <button id="logout-btn" class="btn btn-small">Выйти</button>
                </div>
            </div>
        </header>

        <div class="app-layout">
            <aside class="sidebar">
                <div class="sidebar-header">
                    <div class="user-progress">
                        <div class="progress-info">
                            <span>Прогресс курса:</span>
                            <span class="progress-percentage" id="course-progress">0%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="course-progress-bar" style="width: 0%;"></div>
                        </div>
                    </div>
                </div>
                <nav class="main-nav">
                    <ul>
                        <li class="active"><a href="#" data-section="dashboard"><i class="fas fa-home"></i> Дашборд</a></li>
                        <li><a href="#" data-section="courses"><i class="fas fa-graduation-cap"></i> Курсы</a></li>
                        <li><a href="#" data-section="help"><i class="fas fa-question-circle"></i> Помощь</a></li>
                    </ul>
                </nav>
            </aside>

            <main class="main-content">
                <div class="content-header">
                    <h2>Мой дашборд</h2>
                    <div class="actions">
                        <button class="btn" id="open-api-docs"><i class="fas fa-book"></i> Документация API</button>
                    </div>
                </div>

                <!-- Контейнер для дашборда -->
                <div id="dashboard-container"></div>
                
                <!-- Старый UI списка заданий (скрыт) -->
                <div id="tasks-legacy-ui" style="display:none;">
                    <div class="filters-panel" id="filters-panel"></div>
                    <div class="tasks-grid" id="tasks-container"></div>
                </div>
            </main>
        </div>
    </div>

    <!-- Экран с рабочей областью задания -->
    <div id="workspace-screen" class="screen" style="display: none;">
        <header class="main-header">
            <div class="logo">
                <h1>API Практикум</h1>
            </div>
            <div class="user-info">
                <div class="user-profile">
                    <i class="fas fa-user-circle"></i>
                    <span>Студент</span>
                </div>
            </div>
        </header>

        <div class="app-layout">
            <aside class="sidebar">
                <nav class="main-nav">
                    <ul>
                        <li><a href="#" id="back-to-tasks"><i class="fas fa-arrow-left"></i> К списку заданий</a></li>
                        <li class="active"><a href="#"><i class="fas fa-code"></i> Текущее задание</a></li>
                        <li><a href="api-docs/mock.html" id="open-docs-sidebar"><i class="fas fa-book"></i> Документация API</a></li>
                        <li><a href="#" id="open-hints"><i class="fas fa-lightbulb"></i> Подсказки</a></li>
                    </ul>
                </nav>
            </aside>

            <main class="main-content">
                <div class="content-header">
                    <h2 class="workspace-title">Задание</h2>
                </div>
                <div class="task-details-panel" style="grid-column: 1 / -1; margin-bottom: 1rem;">
                    <h3 class="task-title">Задание</h3>
                    <div class="task-description workspace-description"></div>
                    <div class="task-actions">
                        <button class="btn btn-primary" id="check-solution">
                            <i class="fas fa-check"></i> Проверить решение
                        </button>
                        <button class="btn btn-secondary" id="open-hints">
                            <i class="fas fa-lightbulb"></i> Подсказка
                        </button>
                    </div>
                </div>
                
                <div id="workspace-container" class="workspace-container">
                    <div class="api-client-panel">
                        <div class="api-client-tabs">
                            <div class="api-tab active" data-tab="request">Запрос API</div>
                            <div class="api-tab" data-tab="description">Описание</div>
                            <div class="api-tab" data-tab="verification">Проверка</div>
                        </div>
                        <div class="api-client-tab-content active" id="request-tab">
                            <!-- API источник -->
                            <div class="api-source-selector">
                                <div class="api-source-label">API источник:</div>
                                <div class="api-source-dropdown" id="api-source-dropdown"></div>
                            </div>
                            
                            <!-- HTTP метод и URL -->
                            <div class="http-method-selector">
                                <div class="http-method-label">Метод:</div>
                                <select id="request-method" class="form-control method-select">
                                    <option value="GET">GET</option>
                                    <option value="POST">POST</option>
                                    <option value="PUT">PUT</option>
                                    <option value="DELETE">DELETE</option>
                                    <option value="PATCH">PATCH</option>
                                </select>
                            </div>
                            
                            <div class="url-input-container">
                                <div class="url-input-group">
                                    <input type="text" id="request-url" class="url-input" placeholder="https://api.example.com/resource">
                                    <button id="send-request" class="send-request-button">
                                        <i class="fas fa-paper-plane"></i> Отправить
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Заголовки запроса -->
                            <div class="request-headers">
                                <div class="headers-container" id="headers-container">
                                    <!-- Заголовки будут добавлены через JS -->
                                </div>
                                <button id="add-header" class="add-header-btn">
                                    <i class="fas fa-plus"></i> Добавить заголовок
                                </button>
                            </div>
                            
                            <!-- Тело запроса -->
                            <div class="request-body">
                                <div class="body-container">
                                    <div class="body-title">
                                        Тело запроса
                                        <div class="body-actions">
                                            <button id="format-json-btn" class="btn btn-small">
                                                <i class="fas fa-code"></i> Форматировать JSON
                                            </button>
                                        </div>
                                    </div>
                                    <div class="body-content open">
                                        <textarea id="request-body" class="body-editor"></textarea>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Область ответа -->
                            <div class="response-panel">
                                <div class="response-header">
                                    <h3>Ответ</h3>
                                    <div class="response-meta" id="response-meta"></div>
                                </div>
                                <div class="response-tabs">
                                    <div class="response-tab active" data-tab="body">Тело</div>
                                    <div class="response-tab" data-tab="headers">Заголовки</div>
                                </div>
                                <div class="response-tab-content active" id="body-response-tab">
                                    <pre id="response-body" class="response-body">Отправьте запрос для получения ответа</pre>
                                    <div class="response-controls">
                                        <button id="copy-response-body" class="copy-response-btn">
                                            <i class="fas fa-copy"></i> Копировать
                                        </button>
                                    </div>
                                </div>
                                <div class="response-tab-content" id="headers-response-tab">
                                    <pre id="response-headers" class="response-headers"></pre>
                                    <div class="response-controls">
                                        <button id="copy-response-headers" class="copy-response-btn">
                                            <i class="fas fa-copy"></i> Копировать
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="api-client-tab-content" id="description-tab">
                            <!-- Содержимое вкладки с описанием -->
                            <div class="task-description-full">
                                <h3>Полное описание задания</h3>
                                <div class="task-documentation"></div>
                                <div class="task-examples">
                                    <h4>Примеры запросов</h4>
                                    <div class="examples-container"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="api-client-tab-content" id="verification-tab">
                            <!-- Содержимое вкладки с верификацией -->
                            <div class="verification-container">
                                <div class="verification-header">
                                    <h3>Проверка решения</h3>
                                    <p>В этой области вы можете проверить своё решение задания, ответив на контрольные вопросы.</p>
                                </div>
                                
                                <!-- Секция с вопросами с вариантами ответов -->
                                <div id="multiple-choice-questions" class="question-section">
                                    <!-- Вопросы будут добавлены динамически -->
                                </div>
                                
                                <!-- Секция с вопросами для свободного ответа -->
                                <div id="free-form-questions" class="question-section" style="display: none;">
                                    <!-- Вопросы будут добавлены динамически -->
                                </div>
                                
                                <!-- Кнопка для проверки ответа -->
                                <div class="verification-actions">
                                    <button class="btn btn-primary" id="submit-verification">
                                        <i class="fas fa-check-circle"></i> Проверить ответ
                                    </button>
                                </div>
                                
                                <!-- Секция для отображения результатов -->
                                <div id="verification-results" class="verification-results" style="display: none;">
                                    <!-- Результаты будут добавлены динамически -->
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- AI Ассистент (расположен под панелью ответа) -->
                    <div class="ai-assistant-panel">
                        <div class="ai-assistant-header">
                            <h3><i class="fas fa-robot"></i> AI-ассистент</h3>
                            <p>Задайте вопрос по текущему заданию, и я постараюсь вам помочь.</p>
                        </div>
                        <div class="ai-message-container" id="ai-messages">
                            <div class="ai-message system">
                                <div class="ai-message-content">
                                    <p>Я AI-ассистент, созданный для помощи с API запросами. Опишите, с чем вам помочь, и я постараюсь дать рекомендации по решению задачи.</p>
                                </div>
                                <div class="ai-message-time">сейчас</div>
                            </div>
                        </div>
                        <div class="ai-input-area">
                            <textarea id="ai-input" class="ai-input" placeholder="Опишите вашу проблему или задайте вопрос..." onkeydown="if(event.key === 'Enter' && !event.shiftKey) { event.preventDefault(); window.aiAssistantSendQuestion(); return false; }"></textarea>
                            <button id="send-to-ai" class="btn btn-primary" onclick="window.aiAssistantSendQuestion()">
                                <i class="fas fa-paper-plane"></i> Отправить
                            </button>
                        </div>
                    </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    

    <!-- Контейнер уведомлений -->
    <div id="notifications-container"></div>
    <script type="module" src="main.js"></script>
    <script type="module">
        // Инициализация AI ассистента при загрузке страницы
        import { initAiAssistant } from './src/ai/assistant.js';
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                try {
                    console.log('Запуск инициализации AI ассистента из index.html');
                    initAiAssistant();
                } catch (error) {
                    console.error('Ошибка при инициализации AI ассистента:', error);
                }
            }, 1000);
        });
    </script>
</body>
</html>
